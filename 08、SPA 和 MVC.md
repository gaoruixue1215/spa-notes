### 8、SPA&MVC

整个Web应用由页面组成

#### 1、多页

多页之间数据共享方式

- 扩文档通信
- 客户端存储技术
  - cookie
  - local storage
  - 等

#### 2、单页

Shell 外壳的写法

#### 3、前后端分离

两者比较：

- 前后端分离的单页或多页
- 后台渲染的多页

#### 4、前端路由

> 单页应用程序通常依赖路由器。路由器由路由组成，这些路由描述了它们应匹配的位置。这些路径可以是静态（`/about`）或动态（`/album/:id`的值`:id`可以是任何数量的可能性）路径。路由匹配是将当前位置（通常仅是其路径名）与路由器的路由进行比较，以找到匹配的位置。匹配路由后，路由器将触发应用程序的重新渲染。实际的实现很大程度上取决于路由器。

基本要求：

- 在 spa 仓库创建 51-fe-router 目录
- 页面中有一个 div 块，宽 200px，高 200px，水平居中，默认绿色
- 使用前端路由，例如：`http://ip-addr:8080/#/red` 控制页面中 div 的颜色
- 在 chrome 中测试这个程序，改变 URL 地址后面的颜色单词，观察 div 块的变化
- 点击浏览器的导航键，前进、后退，观察 div 块颜色的变化

```javascript
$(function(){
    window.onhashchange = function(){
        //当 一个窗口的 hash （URL 中 # 后面的部分）改变时就会触发 hashchange 事件
        var $block = $('.main'),
            strHash = window.location.hash,
            color = strHash.substring(3,strHash.length);
        console.log(strHash);// #!/red

        $block.css({
            'background-color':color
        })
    }
})
```

<img src="E:\study\大三下学习\前端性能和工程化\spa-notes\images\08-router.png" alt="08-router" style="zoom:50%;" />

#### 5、MVC是什么？

> MVC全名是Model View Controller，是模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范，用一种业务逻辑、数据、界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面及用户交互的同时，不需要重新编写业务逻辑。MVC被独特的发展起来用于映射传统的输入、处理和输出功能在一个逻辑的图形化用户界面的结构中。
>
> MVC是一种架构模式，它将应用抽象为3个部分：模型（数据）、视图、控制器（分发器）。
>
> 一个事件发生的过程（通信单向流动）：
>
> 1、用户在视图 V 上与应用程序交互
>
> 2、控制器 C 触发相应的事件，要求模型 M 改变状态（读写数据）
>
> 3、模型 M 将数据发送到视图 V ，更新数据，展现给用户

js中的mvc的特点是：**单向流动、事件驱动**

#### 6、MVP是什么？

>Model-View-Presenter 与传统的MVC模式类似，但有一些关键区别：
>
>View没有直接引用Model
>
>Presenter 具有对视图的引用，并根据对模型的更改对其进行更新
>
>**被动视图：**使用Presenter中包含的绝对必要的表示和业务逻辑，将**视图**设计为尽可能幼稚。
>
>**监督控制器：**用于可以扩展声明性视图以包含简单逻辑的系统。只有当视图中的声明性逻辑不能满足系统要求时，Presenter才应该接管。

#### 7、SPA

> 一个单页应用程序（**SPA**）是一个Web应用程序或网站，以提供类似于桌面应用程序中更流畅的用户体验为目标的单一网页上的配合。在SPA中，通常只需响应用户操作，一次加载页面即可检索所有必需的代码（HTML，JavaScript和CSS），或者根据需要动态加载适当的资源并将其添加到页面中。或者，单页应用程序（SPA）是Web应用程序，可加载单个HTML页面并在用户与该应用程序交互时动态更新该页面。

> 单页应用程序的特点是能够重绘UI的任何部分，而无需服务器往返来检索HTML。这是通过具有处理数据的模型层和从模型读取的视图层将数据与数据表示分离开来的。

> 在SPA中，在首页加载后，与服务器的所有交互都通过AJAX调用进行。这些AJAX调用通常以JSON格式返回数据。该应用程序使用JSON数据动态更新页面，而无需重新加载页面。









